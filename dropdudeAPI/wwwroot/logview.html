<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Server Logs</title>
    <style>
        body { font-family: monospace; background: #1e1e1e; color: #dcdcdc; padding: 1em; display: flex; justify-content: center; }
        .container { max-width: 900px; width: 100%; }
        .back-btn { background: #555; color: #fff; border: none; border-radius: 4px; padding: 0.5em 1em; cursor: pointer; margin-bottom: 1em; }
        .back-btn:hover { background: #777; }
        h2 { margin: 0.2em 0 0.8em; text-align: center; }
        .log { background: #000; padding: 1em; border-radius: 6px; max-height: 70vh; overflow-y: auto; font-size: 0.9em; }
        .line { margin-bottom: 4px; white-space: pre-wrap; }
        .info { color: #4fc3f7; }
        .warn { color: #ffb74d; }
        .error { color: #ef5350; }
        #error { text-align: center; margin-top: 0.5em; color: #f55; }
    </style>
</head>
<body>
<div class="container">
    <button class="back-btn" onclick="window.history.back()">‚Üê Back</button>
    <h2>üß† Server Logs</h2>
    <div id="log" class="log">Loading...</div>
    <div id="error"></div>
</div>
<script>
    const token = localStorage.getItem('jwt');
    if (!token) window.location.href = 'login.html';

    let lastLen = 0;

    async function loadLogs() {
        const res = await fetch('/logs', { headers: { 'Authorization': 'Bearer ' + token }, cache: 'no-store' });
        if (!res.ok) {
            document.getElementById('error').textContent = `Error loading logs (${res.status})`;
            return;
        }
        const data = await res.json();
        if (!Array.isArray(data)) {
            document.getElementById('log').textContent = 'Unexpected response';
            return;
        }
        const container = document.getElementById('log');
        if (lastLen === 0) container.innerHTML = '';
        for (let i = lastLen; i < data.length; i++) {
            const el = document.createElement('div');
            el.className = 'line';
            const text = data[i];
            if (text.includes('[Error]')) el.classList.add('error');
            else if (text.includes('[Warning]')) el.classList.add('warn');
            else el.classList.add('info');
            el.textContent = text;
            container.appendChild(el);
        }
        lastLen = data.length;
    }

    loadLogs();
    setInterval(loadLogs, 1000);
</script>
</body>
</html>
